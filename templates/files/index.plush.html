<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1>Files</h1>
    <a href="/files/new" class="btn btn-primary">
      <i class="fas fa-upload"></i> Upload File
    </a>
  </div>

  <%= if (len(files) > 0) { %>
    <div class="row">
      <%= for (file) in files { %>
        <div class="col-md-6 mb-3">
          <div class="card h-100">
            <div class="card-body">
              <h6 class="card-title">
                <i class="fas fa-file"></i> <%= file.Filename %>
              </h6>
              <p class="card-text small text-muted">
                Type: <%= file.ContentType %><br>
                Size: <%= if (file.Size < 1024) { %><%= file.Size %> B<% } else if (file.Size < 1048576) { %><%= file.Size/1024 %> KB<% } else { %><%= file.Size/1048576 %> MB<% } %><br>
                Uploaded: <%= file.CreatedAt.Format("Jan 2, 2006 3:04 PM") %>
              </p>
              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <a href="/files/<%= file.ID %>/download" class="btn btn-sm btn-outline-primary">
                    <i class="fas fa-download"></i> Download
                  </a>
                  <a href="/files/<%= file.ID %>" class="btn btn-sm btn-outline-info">
                    <i class="fas fa-eye"></i> View
                  </a>
                </div>
                <%= if (file.UserID == current_user.ID || current_user.IsOwner()) { %>
                  <form method="POST" action="/files/<%= file.ID %>" style="display: inline;">
                    <input type="hidden" name="_method" value="DELETE">
                    <input type="hidden" name="authenticity_token" value="<%= authenticity_token %>" />
                    <button type="submit" class="btn btn-sm btn-outline-danger" onclick="return confirm('Are you sure?')">
                      <i class="fas fa-trash"></i> Delete
                    </button>
                  </form>
                <% } %>
              </div>
            </div>
          </div>
        </div>
      <% } %>
    </div>
  <% } else { %>
    <div class="alert alert-info">
      <i class="fas fa-info-circle"></i> No files uploaded yet.
      <a href="/files/new">Upload your first file!</a>
    </div>
  <% } %>

  <div class="mt-4">
    <a href="/" class="btn btn-outline-secondary">
      <i class="fas fa-arrow-left"></i> Back to Home
    </a>
  </div>
</div>